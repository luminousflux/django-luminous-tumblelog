{% load url from future %}{% load static %}{% load crispy_forms_tags %}{% load bookmarklet_tags %}{% load encoding %}
<html>
    <head><title>{{site.name}} bookmarklet</title>
        <link rel="stylesheet" href="{% static 'tumblelog/bookmarklet.css' %}" />
        <link rel="stylesheet" href="{% static 'uni_form/uni-form.css' %}" />
        <link rel="stylesheet" href="{% static 'uni_form/default.uni-form.css' %}" />
        <style>
            {% for name in forms.keys %}
            #switcher.{{name}} div.form.{{name}} {
                display: block;
            }
            #switcher.{{name}} ul.tabs li.{{name}} {
                border-bottom: 1px solid transparent;
                font-weight: bold;
            }
            {% endfor %}
        </style>
    </head>
    <body>
        {% if not proper %}
        The bookmarklet is either loading or stuck. If its stuck, try the current bookmarklet version:

        <a href="{{bookmarklink}}">{{site.name}} bookmarklet</a>
        {% else %}
        {% if success %}
            Saved!

            <script>
                window.setTimeout(window.close, 2000);
            </script>
        {% else %}
            <div id="switcher" class="{{mode}}">
            <ul class="tabs">
            {% for name in forms.keys %}
            <li class="{{name}} {% ifequal name mode %}active{% endifequal %}" onclick="document.getElementById('switcher').setAttribute('class','{{name}}');">
                {% if typeimages %}<img src="{% static 'types' %}/icon_{{name|lower}}.png" style="height: 1em;vertical-align: middle;" />{% endif %}
                {{name}}
            </li>
            {% endfor %}
            </ul>
            
            <form method="post" action="{% url 'tumblelog:bookmarklet.html' %}" class="uniForm" style="clear: left;">
                <input type="hidden" name="proper" value="1" />
                <input type="hidden" name="url" value="{{url}}" />
                <input type="hidden" name="images" value="{{images|json|base64}}" />
                <input type="hidden" name="quote" value="{{quote}}" />
                {% for name, form in forms.iteritems %}
                <div class="form {{name}} {% ifequal mode name %}active{%endifequal%} inlineLabels">
                    {{form|crispy}}

                    {% conditional_include_typelet name %}
                    <div class="buttonHolder">
                        <button type="submit" value="{{name}}" name="submit">{{name|title}}</button>
                    </div>
                </div>
                {% endfor %}
            </form>
            </div>
        {% endif %}
        {% endif %}
    </body>
</html>
